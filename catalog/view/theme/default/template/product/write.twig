<script src="catalog/view/javascript/jquery/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="catalog/view/javascript/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="catalog/view/javascript/layer/layer.js" type="text/javascript"></script>
<link href="catalog/view/theme/default/stylesheet/stylesheet.css" rel="stylesheet">
<div id="product-product" class="container" style="margin-top: 10%">
    <h1 style="text-align: center">{{ text_write }}</h1>
<div class="tab-pane" id="tab-review">

{#{% if review_guest %}#}
<form class="form-horizontal" id="form-review">
<div class="form-group required">
  <div class="col-sm-12">
    <label class="control-label" for="input-name">{{ entry_name }}</label>
    <input type="text" name="name" value="{{ customer_name }}" id="input-name" class="form-control" />
  </div>
</div>
<div class="form-group required">
  <div class="col-sm-12">
    <label class="control-label" for="input-review">{{ entry_review }}</label>
    <textarea name="text" rows="5" id="input-review" class="form-control"></textarea>
    <div class="help-block">{{ text_note }}</div>
  </div>
</div>
<div class="form-group required">
  <div class="col-sm-12">
    <label class="control-label mr-1">{{ entry_rating }}</label>
      {{ entry_bad }}
      {% for radio in 1..5 %}
        <input type="radio" name="rating" value="{{ loop.index }}" />
      {% endfor %}
      {{ entry_good }}
  </div>
</div>
{#{{ captcha }}#}
<button type="button" id="button-review" data-loading-text="{{ text_loading }}" class="btn btn-primary">{{ button_submit }}</button>
{#{% else %}#}
{#{{ text_login }}#}
{#{% endif %}#}
</form>
</div>
</div>
<script type="text/javascript">
    $(function($) {
          $('#button-review').on('click', function() {
            $.ajax({
                url: 'index.php?route=product/product/write&product_id={{ id }}',
                type: 'post',
                dataType: 'json',
                data: $("#form-review").serialize(),
                success: function(json) {
                    $('.alert-dismissible').remove();

                    if (json['error']) {
                        layer.msg(json['error']);
                    }

                    if (json['success']) {
                        window.history.go(-1);
                        layer.msg(json['success']);

                        $('input[name=\'name\'], textarea[name=\'text\']').val('');
                        $('input[name=\'rating\']:checked').prop('checked', false);
                    }
                }
            });
        });
    });
</script>

